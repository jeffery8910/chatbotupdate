<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <meta charset="UTF-8" />
    <title>SolveMate（搜脈君）週更報告：2025-11-11 ～ 2025-11-16</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
      :root {
        --bg: #f5f7fb;
        --card: #ffffff;
        --accent: #2563eb;
        --text: #0f172a;
        --muted: #475569;
        --border: #e2e8f0;
      }
      * {
        box-sizing: border-box;
      }
      body {
        margin: 0;
        font-family: "Noto Sans TC", "Segoe UI", system-ui, -apple-system,
          BlinkMacSystemFont, sans-serif;
        background: var(--bg);
        color: var(--text);
        line-height: 1.6;
        padding-bottom: 3rem;
      }
      header {
        background: linear-gradient(135deg, #1e3a8a, #2563eb);
        color: #f8fafc;
        padding: 2.5rem 5vw 2rem;
        box-shadow: 0 6px 20px rgba(15, 23, 42, 0.3);
      }
      header h1 {
        margin: 0 0 0.5rem;
        font-size: 2rem;
      }
      header p {
        margin: 0.2rem 0;
        color: #cbd5f5;
      }
      .stats {
        margin-top: 1.5rem;
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
        gap: 1rem;
      }
      .stat-card {
        background: rgba(15, 23, 42, 0.3);
        border-radius: 12px;
        padding: 1rem 1.2rem;
      }
      .stat-card h4 {
        margin: 0;
        font-size: 0.95rem;
        text-transform: uppercase;
        letter-spacing: 0.08em;
        color: #e2e8f0;
      }
      .stat-card p {
        margin: 0.4rem 0 0;
        font-size: 1.35rem;
        font-weight: 600;
        color: #fff;
      }
      main {
        padding: 2.5rem 5vw;
        display: flex;
        flex-direction: column;
        gap: 2rem;
      }
      section {
        background: var(--card);
        border-radius: 16px;
        padding: 1.8rem;
        box-shadow: 0 12px 30px rgba(15, 23, 42, 0.08);
        border: 1px solid var(--border);
      }
      section h2 {
        margin-top: 0;
        margin-bottom: 1rem;
        font-size: 1.5rem;
      }
      .highlight-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(230px, 1fr));
        gap: 1.2rem;
      }
      .highlight-grid article {
        border: 1px solid var(--border);
        border-radius: 12px;
        padding: 1rem 1.1rem;
        background: #f8fafc;
      }
      .highlight-grid h3 {
        margin: 0 0 0.6rem;
        font-size: 1.1rem;
        color: var(--accent);
      }
      .highlight-grid ul {
        padding-left: 1.2rem;
        margin: 0;
        color: var(--muted);
        font-size: 0.95rem;
      }
      .highlight-grid li + li {
        margin-top: 0.4rem;
      }
      .timeline .day {
        margin-bottom: 1.8rem;
      }
      .timeline h3 {
        margin-bottom: 0.8rem;
        font-size: 1.1rem;
        color: var(--accent);
      }
      .commit {
        border-left: 3px solid var(--accent);
        padding-left: 1rem;
        margin-bottom: 1.2rem;
      }
      .commit-header {
        display: flex;
        flex-wrap: wrap;
        gap: 0.6rem;
        font-weight: 600;
        font-family: "JetBrains Mono", Consolas, "Courier New", monospace;
        color: var(--text);
      }
      .commit-header span {
        background: rgba(37, 99, 235, 0.12);
        padding: 0.05rem 0.45rem;
        border-radius: 6px;
      }
      .commit-summary {
        margin: 0.4rem 0 0.2rem;
        font-weight: 600;
        color: var(--text);
      }
      .commit ul {
        margin: 0.4rem 0 0;
        padding-left: 1.2rem;
        color: var(--muted);
        font-size: 0.95rem;
      }
      .commit li + li {
        margin-top: 0.35rem;
      }
      .notes p {
        margin: 0.3rem 0;
        color: var(--muted);
        font-size: 0.92rem;
      }
      .footnote {
        font-size: 0.85rem;
        color: var(--muted);
        margin-top: 1rem;
      }
      @media (max-width: 640px) {
        header,
        main {
          padding-left: 1.2rem;
          padding-right: 1.2rem;
        }
        .commit-header {
          flex-direction: column;
          align-items: flex-start;
        }
      }
    </style>
  </head>
  <body>
    <header>
      <h1>Student Chatbot 更新週報</h1>
      <p>本週重點：LLM 健康監控、教職員主控台與知識圖譜</p>
      <div class="stats">
        <div class="stat-card">
          <h4>Commits</h4>
          <p>30</p>
        </div>
        <div class="stat-card">
          <h4>新增行數</h4>
          <p>54,881</p>
        </div>
        <div class="stat-card">
          <h4>刪除行數</h4>
          <p>9,566</p>
        </div>
        <div class="stat-card">
          <h4>主要作者</h4>
          <p>jeffery8910</p>
        </div>
      </div>
    </header>
    <main>
      <section class="highlights">
        <h2>本週亮點</h2>
        <div class="highlight-grid">
          <article>
            <h3>Agent D 異常偵測</h3>
            <ul>
              <li>導入 <code>EngagementOutlier</code> schema，並新增 cron `/api/cron/agent-d/run`，可針對最近 3 天的學習紀錄偵測出互動異常的學生。</li>
              <li>Review 與摘要流程可以讀取最新的 outlier 記錄，後續會提供 Reviewer AI 與導師作為關懷依據。</li>
              <li>新增 `/api/admin/outliers` 與 Outliers Panel，讓管理員可以在 Admin 後台過濾、分頁檢視與追蹤異常個案。</li>
            </ul>
          </article>
          <article>
            <h3>Admin 狀態與工具台</h3>
            <ul>
              <li>整理 `AdminApiStatus`、`BackendHealthPage`、`ChatMessageTools` 等元件結構，將 API 健康度、訊息查詢與 outlier 檢視集中在同一張總覽版面。</li>
              <li>新增 `KnowledgeDiagnosePage`、`ProviderTrendsPage`、`LlmStatusWidget`、`LlmSimPage`、`RagQueriesPage`、`SystemBlueprintPage`，顯示 24 小時內的 LLM 呼叫趨勢、fallback 統計與知識圖結構診斷。</li>
              <li>更新 `server/routes/apiRoutes.js` 與相關 utils，補齊 LLM 測試、模擬與記錄 API，讓 Admin 可以直接從前端觸發健康檢查。</li>
            </ul>
          </article>
          <article>
            <h3>RAG 與知識圖譜</h3>
            <ul>
              <li>完成 KnowledgeStructureGraph、AdminKnowledgeBase、DatasetWorkspace 以及 RagDataset model 與 ingestion service 的第一版整合，建立清楚的「單元 → chunk → 題目」對應關係。</li>
              <li>建置大型 starmap 星圖（indicator_map / edges、concept_hub、xlsx 匯出），用來檢查單元前後關聯與測驗覆蓋度。</li>
              <li>新增 Dataset overview / Document table / Ingestion monitor 卡片，讓 Admin 可以即時看到各資料集的文件數量、chunk 狀態與 ingestion queue 進度。</li>
            </ul>
          </article>
          <article>
            <h3>使用者體驗與文件</h3>
            <ul>
              <li>完成 Google OAuth 串接流程（登入頁、Header、SessionsSidebar、zh-TW 文案），並修正相關錯誤畫面截圖與導回邏輯。</li>
              <li>更新多份文件：`DEPLOYMENT.md`、API/UI 對照表、Code Architecture、RemindAI & Mermaid 設計等，確保開發與維運流程有清楚指引。</li>
              <li>新增 RemindLanding、Engagement Settings 與 Reviewer Prompts 調整，將 RAG 測驗體驗與「提醒型教學」流程串成一條完整路徑。</li>
            </ul>
          </article>
          <article>
            <h3>教職員主控台與公告分眾</h3>
            <ul>
              <li>新增 `TeacherDashboard` 以及 `/teacher` 路由，提供教職員與管理員專用的總覽介面，可快速開啟成員清單（唯讀）與出題工具。</li>
              <li>擴充 `AdminStudentsList`，加入角色篩選、班級 `classId` 欄位與「直接從列表修改班級」的操作，後端對應 `PATCH /api/admin/students/:id/class` 與 `GET /api/admin/classes`。</li>
              <li>實作公告設定頁 `AnnouncementSettingsPage` 與前端 banner `AnnouncementBar`，支援 `scope`（all / classes / users / mixed）、班級與 Email 清單，儲存時若有不存在的 Email 會顯示錯誤並阻止儲存；同時整合 `/api/admin/llm/status`，在 Admin 頁面優先顯示 LLM 金鑰遺失或 fallback 警示。</li>
            </ul>
          </article>
        </div>
      </section>

      <section class="timeline">
        <h2>每日交付紀錄</h2>

        <div class="day">
          <h3>2025-11-12（週三）</h3>
          <article class="commit">
            <div class="commit-header">
              <span>5fc2102</span><span>15:34</span><span>first commit</span>
            </div>
            <p class="commit-summary">功能：建立 React SPA 與 Node API 骨架，奠定聊天、測驗與 RAG 的基本路由。</p>
            <ul>
              <li>`App.tsx`、`server/index.ts`、`server/routes/apiRoutes.js`：建立學生聊天 SPA 與 Node/Express API，統一路徑下接上 RAG 與測驗 API。</li>
              <li>`.github/workflows/*.yml`、`AGENTS.md`、`docs/*`：整理 CI、開發規範與文件結構，確保後續功能都有清楚的測試與說明。</li>
            </ul>
          </article>
          <article class="commit">
            <div class="commit-header">
              <span>da14e3c</span><span>16:37</span><span>feat(agent-d): add outlier cron</span>
            </div>
            <p class="commit-summary">功能：讓 Agent D 可以定期掃描互動紀錄並寫入 EngagementOutlier。</p>
            <ul>
              <li>`server/models/EngagementOutlier.js`、`server/routes/apiRoutes.js`、`server/routes/summary.ts`：新增異常紀錄模型，並實作 `/api/cron/agent-d/run` 支援 dryRun / persist。</li>
              <li>`server/services/quizRagGenerator.js`、`components/QuizMessage.tsx`：將 quiz 解析與 reviewer hook 串進 outlier 流程，方便之後做關鍵題目回顧。</li>
            </ul>
          </article>
          <article class="commit">
            <div class="commit-header">
              <span>390874a</span><span>16:54</span><span>feat(agent-d): admin outliers view</span>
            </div>
            <p class="commit-summary">功能：在 Admin 後台提供 outliers 檢視頁，方便追蹤與匯出。</p>
            <ul>
              <li>`server/routes/apiRoutes.js`：新增 `GET /api/admin/outliers`，支援條件篩選與分頁。</li>
              <li>`components/admin/OutliersPanel.tsx`：建立對應的表格與過濾 UI，方便導師搜尋特定學生或時間區間。</li>
            </ul>
          </article>
        </div>

        <div class="day">
          <h3>2025-11-13（週四）</h3>
          <article class="commit">
            <div class="commit-header">
              <span>0baf4e2</span><span>01:52</span><span>update</span>
            </div>
            <p class="commit-summary">功能：優化 Admin API 設定表單，降低誤觸 fallback 參數的風險。</p>
            <ul>
              <li>`components/AdminApiSettings.tsx`：重構 Provider / Model / Key 欄位排版，針對 fallback 相關選項加上更明顯的說明與預設值。</li>
            </ul>
          </article>
          <article class="commit">
            <div class="commit-header">
              <span>eab5f01</span><span>02:21</span><span>update</span>
            </div>
            <p class="commit-summary">功能：補上型別檢查與基礎語法檢查，避免 Admin 表單在編譯期就壞掉。</p>
            <ul>
              <li>`components/AdminApiSettings.tsx`、`components/ChatInterface.tsx`、`components/admin/AdminUnitsPage.tsx`：整理 props 與 state 型別，並新增 `tsconfig.syntaxcheck.json` 做快速 TS 檢查。</li>
            </ul>
          </article>
          <article class="commit">
            <div class="commit-header">
              <span>617201a</span><span>05:12</span><span>google oauth</span>
            </div>
            <p class="commit-summary">功能：導入 Google OAuth，讓學生可以用 Google 帳號登入並保留歷史對話。</p>
            <ul>
              <li>`App.tsx`、`components/Header.tsx`、`components/chat/SessionsSidebar.tsx`：接上 Google OAuth 登入流程與 session 清單，並處理登入後的導流。</li>
              <li>`i18n/locales/zh-TW.ts`：補齊登入相關的 zh-TW 文案與錯誤訊息。</li>
            </ul>
          </article>
        </div>

        <div class="day">
          <h3>2025-11-14（週五）</h3>
          <article class="commit">
            <div class="commit-header">
              <span>4450166</span><span>01:41</span><span>page update</span>
            </div>
            <p class="commit-summary">功能：整理 Admin 儀表板資訊架構，加入 LLM 狀態與 Graph 相關頁面。</p>
            <ul>
              <li>`AGENTS.md`、`components/AdminApiStatus.tsx`、`components/admin/OutliersPanel.tsx`、`components/admin/QuizGenerateTester.tsx`：調整版面與說明文字，讓 Admin 可以更快找到常用工具。</li>
              <li>`docs/DEV-TESTS.md`、`docs/LLM-and-Graph-Plan.md`、`docs/UI-NOTES.md`、`docs/units-tags.md`：更新測試清單與知識圖規格，方便之後擴充。</li>
            </ul>
          </article>
          <article class="commit">
            <div class="commit-header">
              <span>e2478c5</span><span>03:01</span><span>update</span>
            </div>
            <p class="commit-summary">功能：新增 Knowledge Diagnose 與 Provider Trends 頁面，打通 LLM 健康診斷鏈。</p>
            <ul>
              <li>`App.tsx`、`components/admin/KnowledgeDiagnosePage.tsx`、`components/admin/ProviderTrendsPage.tsx`：加入對應路由與版面，聚焦 24 小時內的 fallback / error 走勢。</li>
              <li>`docs/ADMIN-ROUTES.md`、`docs/DEV-TESTS-addendum.md`、`docs/P2-PLAN.md`、`server/utils/providerTestLog.js`：補上 API 路由與 provider 測試 log 的結構說明。</li>
            </ul>
          </article>
          <article class="commit">
            <div class="commit-header">
              <span>96e718c</span><span>03:08</span><span>update</span>
            </div>
            <p class="commit-summary">功能：補齊 LLM 模擬測試、RAG 查詢與系統藍圖的前後端 API。</p>
            <ul>
              <li>`components/admin/LlmSimPage.tsx`、`components/admin/LlmStatusWidget.tsx`、`components/admin/RagQueriesPage.tsx`、`components/admin/SystemBlueprintPage.tsx`：提供可視化的 LLM 模擬結果與 RAG 查詢紀錄。</li>
              <li>`server/routes/apiRoutes.js`、`server/utils/llmSim.js`、`server/utils/llmProvider.js`：實作對應 API 與 provider 抽象層。</li>
            </ul>
          </article>
        </div>

        <div class="day">
          <h3>2025-11-15（週六）</h3>
          <article class="commit">
            <div class="commit-header">
              <span>55a4036</span><span>09:03</span><span>RAG</span>
            </div>
            <p class="commit-summary">功能：補完 RemindLanding 與資料圖譜 CTA，連結 RAG 體驗。</p>
            <ul>
              <li>`App.tsx`、`components/RemindLanding.tsx`、`hooks/useRemindLanding.ts`：建立 Remind 專用 landing，將圖譜與測驗結果導回具體 CTA。</li>
              <li>`docs/API_AND_UI_MAP_2025-11.md`、`docs/CODE_ARCHITECTURE_OVERVIEW_2025-11.md`、`docs/RemindAI-and-Mermaid-Plan.md`：更新架構圖與流程說明。</li>
            </ul>
          </article>
          <article class="commit">
            <div class="commit-header">
              <span>4563bf5</span><span>10:20</span><span>SolveMate branding</span>
            </div>
            <p class="commit-summary">功能：前後端視覺全面收斂為 SolveMate 品牌。</p>
            <ul>
              <li>`components/Login.tsx`、`components/Header.tsx`、`index.html`、`public/logo-512.png`：更新登入畫面、標題列與 favicon，統一 SolveMate 名稱與圖示。</li>
              <li>`components/Message.tsx`、`components/icons/index.tsx`：新增 SolveMate glyph 與訊息頭像，讓學生在對話中能一眼看出是「搜脈君」回覆。</li>
            </ul>
          </article>
          <article class="commit">
            <div class="commit-header">
              <span>6969724</span><span>17:37</span><span>Type & docs cleanup</span>
            </div>
            <p class="commit-summary">功能：清理型別錯誤與文件舊字眼，確保 SolveMate 命名一致。</p>
            <ul>
              <li>`components/AdminApiSettings.tsx`、`components/AdminApiStatus.tsx`：修正 Admin API 設定/狀態頁的型別與 props 錯誤。</li>
              <li>`README.md`、`docs/README.md`、`docs/knowledge-base-playbook.md`：整理專案說明與知識庫操作手冊，並把舊文件移到 `docs/outdated/`。</li>
            </ul>
          </article>
          <article class="commit">
            <div class="commit-header">
              <span>40bfb7c</span><span>22:54</span><span>Teacher console & announcements</span>
            </div>
            <p class="commit-summary">功能：導入教職員主控台、班級欄位與公告分眾，讓老師也能直接掌握狀態。</p>
            <ul>
              <li>`App.tsx`、`components/TeacherDashboard.tsx`、`components/Header.tsx`：新增 `/teacher` 體驗，提供教職員專用入口，整合成員清單、出題測試與 LLM 健康摘要。</li>
              <li>`components/AdminStudentsList.tsx`：新增角色篩選、`classId` 顯示與「從清單直接修改班級」功能，對應 `PATCH /api/admin/students/:id/class`、`GET /api/admin/students` 與 `GET /api/admin/classes`。</li>
              <li>`components/admin/AnnouncementSettingsPage.tsx`、`components/AnnouncementBar.tsx`：實作公告設定與前端 banner，支援依班級與 Email 分眾；並在 Admin 頁面上方顯示 LLM 金鑰遺失與 fallback 警示（整合 `/api/admin/llm/status`）。</li>
            </ul>
          </article>
        </div>

        <div class="day">
          <h3>2025-11-16（週日）</h3>
          <article class="commit">
            <div class="commit-header">
              <span>7b69fb8</span><span>04:55</span><span>announcement & ingestion polish</span>
            </div>
            <p class="commit-summary">功能：微調公告設定與 RAG ingestion pipeline，補上錯誤處理與欄位檢查。</p>
            <ul>
              <li>`components/admin/AnnouncementSettingsPage.tsx`：調整表單 state 控制與錯誤顯示，確保 scope、班級與 Email 欄位在儲存前都有完整檢查。</li>
              <li>`components/AdminApiSettings.tsx`：同步優化 provider / 模型設定的提示文字與預設值，讓 Admin 比較不容易誤設 fallback 或錯誤的 key。</li>
              <li>`server/routes/apiRoutes.js`、`server/services/ragIngestionService.js`、`server/utils/rag.js`：整理 ingestion API 與 helper，減少重複邏輯並補上 edge case 的錯誤處理。</li>
            </ul>
          </article>
        </div>
      </section>

      <section class="notes">
        <h2>備註與後續方向</h2>
        <p>1. LLM Fallback 與狀態 API 已可回報 24 小時內的呼叫量、fallback 次數與錯誤類型，後續會再補上更多圖表與警示等級。</p>
        <p>2. 教職員主控台目前聚焦在「看得到但改不動」的工具（成員清單、LLM 狀態、出題測試），所有權限敏感的操作仍需經由 Admin Dashboard。</p>
        <p>3. 公告分眾邏輯已串上 `settings.announcement` 與 `/api/announcement`，接下來會依實際使用狀況調整 UI 與文案。</p>
        <p class="footnote">本週報僅涵蓋 2025-11-11 ～ 2025-11-16 的主要變更，詳細 API 與前端設計請參考專案內的 docs/* 檔案。</p>
      </section>
    </main>
  </body>
</html>

